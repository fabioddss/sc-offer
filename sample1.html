<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SanaClis Strategic Clinical Intelligence — Sample Dashboard (Synthetic Data)</title>
<style>
  :root {
    --bg: #0b1220;
    --panel: rgba(19, 29, 52, .68);
    --panel2: rgba(13, 20, 37, .65);
    --stroke: rgba(255,255,255,.08);
    --text: #e8eefc;
    --muted: rgba(232,238,252,.70);
    --dim: rgba(232,238,252,.45);
    --blue: #4ea1ff;
    --cyan: #2ee9c5;
    --green: #40d67d;
    --amber: #ffbf44;
    --red: #ff4d6d;
    --shadow: 0 18px 60px rgba(0,0,0,.45);
    --radius: 18px;
    --radius2: 14px;
    --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  }

  * { box-sizing: border-box; }
  body {
    margin:0;
    font-family: var(--sans);
    color: var(--text);
    background:
      radial-gradient(1200px 600px at 15% 0%, rgba(78,161,255,.18), transparent 55%),
      radial-gradient(900px 600px at 80% 10%, rgba(46,233,197,.16), transparent 55%),
      radial-gradient(800px 500px at 45% 70%, rgba(64,214,125,.10), transparent 60%),
      linear-gradient(180deg, #050a14 0%, var(--bg) 38%, #060b16 100%);
    min-height:100vh;
  }

  a { color: var(--blue); text-decoration: none; }
  .wrap { max-width: 1200px; margin: 0 auto; padding: 22px 18px 60px; }

  .hero {
    position: relative;
    border: 1px solid var(--stroke);
    border-radius: calc(var(--radius) + 6px);
    overflow: hidden;
    box-shadow: var(--shadow);
    background:
      radial-gradient(900px 420px at 20% 0%, rgba(78,161,255,.22), transparent 65%),
      radial-gradient(700px 420px at 85% 30%, rgba(46,233,197,.18), transparent 65%),
      linear-gradient(180deg, rgba(19,29,52,.85), rgba(13,20,37,.55));
  }
  .heroInner {
    padding: 34px 28px 26px;
    display: grid;
    grid-template-columns: 1.4fr .6fr;
    gap: 18px;
    align-items: start;
  }
  .brand {
    display:flex; gap:12px; align-items:center;
  }
  .logo {
    width: 44px; height:44px;
    border-radius: 14px;
    background: linear-gradient(135deg, rgba(78,161,255,.9), rgba(46,233,197,.9));
    box-shadow: 0 10px 30px rgba(78,161,255,.22);
    position: relative;
  }
  .logo:after {
    content:"";
    position:absolute; inset: 10px;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,.35);
    background: rgba(10, 14, 28, .25);
  }
  h1 {
    margin: 10px 0 8px;
    font-size: clamp(24px, 3.4vw, 40px);
    line-height: 1.12;
    letter-spacing: -0.02em;
  }
  .sub {
    color: var(--muted);
    font-size: 14px;
    max-width: 62ch;
  }
  .meta {
    display:flex; flex-wrap:wrap; gap:10px;
    margin-top: 14px;
  }
  .chip {
    display:inline-flex; align-items:center; gap:8px;
    padding: 8px 10px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.14);
    color: var(--muted);
    font-size: 12px;
  }
  .chip b { color: var(--text); font-weight: 700; }
  .rightBox {
    display:flex; flex-direction:column; gap:10px;
    justify-self: end;
    text-align:right;
  }
  .pill2 {
    display:inline-flex; justify-content:flex-end;
    font-family: var(--mono);
    font-size: 12px;
    color: rgba(232,238,252,.78);
  }
  .disclaimer {
    margin-top: 10px;
    font-size: 12px;
    color: var(--dim);
  }

  /* Layout grid */
  .grid {
    margin-top: 18px;
    display:grid;
    grid-template-columns: 1fr;
    gap: 14px;
  }
  @media (min-width: 980px) {
    .grid {
      grid-template-columns: 1.0fr 1.0fr;
      gap: 14px;
    }
    .span2 { grid-column: 1 / -1; }
  }

  .panel {
    border: 1px solid var(--stroke);
    border-radius: var(--radius);
    background: var(--panel);
    box-shadow: var(--shadow);
    overflow: hidden;
  }
  .panelHeader {
    padding: 16px 18px 10px;
    border-bottom: 1px solid rgba(255,255,255,.07);
    display:flex;
    align-items: baseline;
    justify-content: space-between;
    gap: 10px;
  }
  .panelHeader h2 {
    margin:0;
    font-size: 15px;
    letter-spacing: .02em;
    text-transform: uppercase;
    color: rgba(232,238,252,.88);
  }
  .panelHeader .hint {
    color: var(--dim);
    font-size: 12px;
  }
  .panelBody {
    padding: 14px 18px 18px;
  }

  /* KPI cards */
  .kpis {
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
  }
  @media (min-width: 700px) {
    .kpis { grid-template-columns: repeat(4, 1fr); }
  }
  .kpi {
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.14);
    border-radius: 16px;
    padding: 12px 12px 10px;
    position: relative;
    overflow:hidden;
  }
  .kpi:before {
    content:"";
    position:absolute; inset:-60px -60px auto auto;
    width:120px; height:120px;
    background: radial-gradient(circle at 30% 30%, rgba(78,161,255,.45), transparent 60%);
    transform: rotate(15deg);
  }
  .kpi .label {
    color: var(--dim);
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: .08em;
  }
  .kpi .value {
    margin-top: 6px;
    font-size: 20px;
    font-weight: 800;
    letter-spacing: -.02em;
  }
  .kpi .delta {
    margin-top: 6px;
    font-size: 12px;
    color: var(--muted);
  }
  .tagGood { color: var(--green); font-weight: 700; }
  .tagWarn { color: var(--amber); font-weight: 700; }
  .tagBad { color: var(--red); font-weight: 700; }

  /* Toggle + toolbar */
  .toolbar {
    display:flex;
    flex-wrap: wrap;
    align-items:center;
    justify-content: space-between;
    gap: 10px;
    margin: 8px 0 14px;
  }
  .seg {
    display:inline-flex;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(0,0,0,.18);
    border-radius: 999px;
    overflow:hidden;
  }
  .seg button {
    border:0;
    background: transparent;
    color: var(--muted);
    padding: 10px 12px;
    font-size: 12px;
    cursor:pointer;
  }
  .seg button.active {
    background: linear-gradient(135deg, rgba(78,161,255,.65), rgba(46,233,197,.55));
    color: #07101f;
    font-weight: 800;
  }
  .search {
    display:flex; align-items:center; gap:10px;
    flex:1;
    justify-content:flex-end;
  }
  .search input {
    width: min(520px, 100%);
    background: rgba(0,0,0,.22);
    border: 1px solid rgba(255,255,255,.12);
    color: var(--text);
    border-radius: 14px;
    padding: 10px 12px;
    outline:none;
    font-size: 12px;
  }
  .search input::placeholder { color: rgba(232,238,252,.38); }

  /* Canvas containers */
  .canvasWrap {
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.12);
    padding: 12px;
  }
  .row2 {
    display:grid;
    grid-template-columns: 1fr;
    gap: 10px;
  }
  @media(min-width: 900px) {
    .row2 { grid-template-columns: 1fr 1fr; }
  }

  .legend {
    display:flex; flex-wrap:wrap; gap:10px; margin-top: 10px;
    color: var(--muted); font-size: 12px;
  }
  .dot {
    width:10px; height:10px; border-radius: 999px; display:inline-block; margin-right:6px;
  }

  /* Map */
  .mapWrap {
    display:grid;
    grid-template-columns: 1fr;
    gap: 10px;
  }
  @media(min-width: 900px) {
    .mapWrap { grid-template-columns: 1.2fr .8fr; }
  }
  .mapNote {
    color: var(--muted);
    font-size: 12px;
    line-height: 1.45;
  }
  .callout {
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.14);
    padding: 12px;
  }
  .callout h3 {
    margin: 0 0 6px;
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: .06em;
    color: rgba(232,238,252,.85);
  }
  .callout ul {
    margin: 8px 0 0 18px;
    color: var(--muted);
    font-size: 12px;
  }

  /* 40 items grid */
  .items {
    display:grid;
    grid-template-columns: 1fr;
    gap: 10px;
  }
  @media(min-width: 760px) {
    .items { grid-template-columns: 1fr 1fr; }
  }
  @media(min-width: 1100px) {
    .items { grid-template-columns: 1fr 1fr 1fr; }
  }
  .card {
    border: 1px solid rgba(255,255,255,.10);
    border-radius: var(--radius2);
    background: rgba(0,0,0,.14);
    padding: 12px 12px 10px;
    transition: transform .18s ease, border-color .18s ease, background .18s ease;
  }
  .card:hover {
    transform: translateY(-2px);
    border-color: rgba(78,161,255,.35);
    background: rgba(0,0,0,.18);
  }
  .itemTop {
    display:flex;
    gap: 10px;
    justify-content: space-between;
    align-items: flex-start;
  }
  .idx {
    display:inline-flex;
    width: 28px; height: 28px;
    border-radius: 10px;
    align-items:center; justify-content:center;
    background: rgba(78,161,255,.14);
    border: 1px solid rgba(78,161,255,.22);
    color: rgba(232,238,252,.92);
    font-family: var(--mono);
    font-size: 12px;
    margin-right: 8px;
  }
  .itemTitle {
    font-weight: 800;
    letter-spacing: -.01em;
    line-height: 1.25;
    font-size: 13px;
  }
  .itemStars {
    font-family: var(--mono);
    font-size: 12px;
    color: var(--amber);
    opacity: .95;
    white-space: nowrap;
  }
  .itemTech {
    margin-top: 8px;
    color: var(--muted);
    font-size: 12px;
    line-height: 1.35;
  }
  .pill {
    display:inline-block;
    font-family: var(--mono);
    font-size: 11px;
    padding: 2px 7px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.14);
    margin-right: 8px;
    color: rgba(232,238,252,.80);
    background: rgba(0,0,0,.18);
  }

  .tier-1 { border-left: 3px solid rgba(255,77,109,.9); }
  .tier-2 { border-left: 3px solid rgba(255,191,68,.9); }
  .tier-3 { border-left: 3px solid rgba(64,214,125,.85); }

  /* Footer CTA */
  .cta {
    margin-top: 14px;
    padding: 18px;
    border-radius: var(--radius);
    border: 1px solid rgba(255,255,255,.12);
    background:
      radial-gradient(700px 240px at 30% 10%, rgba(78,161,255,.18), transparent 60%),
      radial-gradient(700px 240px at 80% 40%, rgba(46,233,197,.16), transparent 60%),
      rgba(0,0,0,.18);
    display:flex;
    flex-wrap: wrap;
    align-items:center;
    justify-content: space-between;
    gap: 12px;
  }
  .cta h3 {
    margin:0;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: .08em;
    color: rgba(232,238,252,.86);
  }
  .cta p {
    margin: 8px 0 0;
    color: var(--muted);
    font-size: 12px;
    max-width: 78ch;
  }
  .btn {
    display:inline-flex;
    align-items:center; justify-content:center;
    gap: 10px;
    padding: 12px 14px;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,.12);
    background: linear-gradient(135deg, rgba(78,161,255,.85), rgba(46,233,197,.75));
    color: #07101f;
    font-weight: 900;
    letter-spacing: .02em;
    cursor:pointer;
    user-select:none;
    box-shadow: 0 18px 45px rgba(78,161,255,.18);
  }
  .btn small {
    font-weight: 800;
    font-family: var(--mono);
    opacity: .8;
  }

  /* Tiny toast */
  .toast {
    position: fixed;
    bottom: 16px; left: 50%;
    transform: translateX(-50%);
    background: rgba(0,0,0,.58);
    border: 1px solid rgba(255,255,255,.14);
    border-radius: 999px;
    padding: 10px 14px;
    color: rgba(232,238,252,.84);
    font-size: 12px;
    backdrop-filter: blur(10px);
    opacity: 0;
    pointer-events: none;
    transition: opacity .22s ease, transform .22s ease;
  }
  .toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(-4px);
  }
</style>
</head>
<body>
<div class="wrap">

  <section class="hero">
    <div class="heroInner">
      <div>
        <div class="brand">
          <div class="logo"></div>
          <div>
            <div style="font-family:var(--mono); color:rgba(232,238,252,.75); font-size:12px;">FDS • Strategic Risk Architecture</div>
            <div style="font-size:12px; color:var(--dim);">Clinical Intelligence • Dynamic Systems • AI/ML Forensics</div>
          </div>
        </div>
        <h1>SanaClis Strategic Clinical Intelligence — Sample Dashboard (Synthetic Data)</h1>
        <div class="sub">Dynamic System Stability • Forensic Integrity • AI-Assisted Risk Architecture</div>

        <div class="meta">
          <div class="chip">Mode: <b>Demo</b> (synthetic)</div>
          <div class="chip">Scope: <b>Plinabulin DSN</b> + <b>Universal Flu Vaccine</b></div>
          <div class="chip">Output: <b>Board-ready</b> + <b>Regulatory-ready</b></div>
          <div class="chip">Engagement: <b>€250k</b> per study analysis</div>
        </div>

        <div class="disclaimer">
          Disclaimer: This dashboard is a <b>sample</b> designed to demonstrate what an end-to-end “performed study analysis” can look like.
          All charts and site signals below are generated from <b>synthetic data</b> and <b>do not represent</b> any real patient/site outcomes.
        </div>
      </div>

      <div class="rightBox">
        <div class="pill2">Build: 2026-02-14</div>
        <div class="pill2">Data Model: SDTM/ADaM-ready • SQL Server-ready</div>
        <div class="pill2">Engine: C++ deterministic core • AI/ML layer optional</div>
        <div class="pill2">Focus: Stability • Integrity • Replication</div>
      </div>
    </div>
  </section>

  <div class="grid">
    <section class="panel span2">
      <div class="panelHeader">
        <h2>Executive Snapshot</h2>
        <div class="hint">KPI tiles update with the study toggle below</div>
      </div>
      <div class="panelBody">
        <div class="toolbar">
          <div class="seg" id="studySeg">
            <button class="active" data-study="neutro">Protective-1 (Neutropenia)</button>
            <button data-study="flu">BVX-010 (Flu Vaccine)</button>
          </div>
          <div class="search">
            <input id="globalSearch" placeholder="Search the 40 analysis products (e.g., 'regime', 'copula', 'integrity', 'hazard')..." />
          </div>
        </div>

        <div class="kpis" id="kpis"></div>
      </div>
    </section>

    <section class="panel">
      <div class="panelHeader">
        <h2>Dynamic System View</h2>
        <div class="hint">Trajectories + regime markers (synthetic)</div>
      </div>
      <div class="panelBody">
        <div class="canvasWrap">
          <canvas id="trajChart" width="520" height="260" style="width:100%; height:auto;"></canvas>
          <div class="legend">
            <span><i class="dot" style="background:rgba(78,161,255,.95)"></i>Arm A</span>
            <span><i class="dot" style="background:rgba(46,233,197,.95)"></i>Arm B</span>
            <span><i class="dot" style="background:rgba(255,191,68,.95)"></i>Regime switch</span>
            <span><i class="dot" style="background:rgba(255,77,109,.95)"></i>Threshold boundary</span>
          </div>
        </div>
        <div class="mapNote" style="margin-top:10px;">
          This view demonstrates how we treat endpoint behavior as a <b>time-evolving system</b>: suppression → nadir → recovery.
          We focus on structural differences (slopes, timing, regime shifts), not only endpoint aggregates.
        </div>
      </div>
    </section>

    <section class="panel">
      <div class="panelHeader">
        <h2>Forensic Integrity Layer</h2>
        <div class="hint">Site fingerprint heatmap + anomaly flags (synthetic)</div>
      </div>
      <div class="panelBody">
        <div class="canvasWrap">
          <canvas id="heatChart" width="520" height="260" style="width:100%; height:auto;"></canvas>
        </div>
        <div class="mapNote" style="margin-top:10px;">
          Integrity fingerprint combines: entropy of trajectories, timestamp granularity, variance compression, and multivariate dependence stability.
          Highlighted cells indicate <b>“too perfect”</b> patterns inconsistent with biology/logistics.
        </div>
      </div>
    </section>

    <section class="panel span2">
      <div class="panelHeader">
        <h2>Geo / Site Signal Map</h2>
        <div class="hint">Heat points and site risk bands (synthetic)</div>
      </div>
      <div class="panelBody">
        <div class="mapWrap">
          <div class="canvasWrap">
            <svg id="siteMap" viewBox="0 0 820 360" width="100%" height="auto" style="display:block;">
              <defs>
                <radialGradient id="glowBlue" cx="50%" cy="50%" r="60%">
                  <stop offset="0%" stop-color="rgba(78,161,255,.65)"/>
                  <stop offset="100%" stop-color="rgba(78,161,255,0)"/>
                </radialGradient>
                <radialGradient id="glowRed" cx="50%" cy="50%" r="60%">
                  <stop offset="0%" stop-color="rgba(255,77,109,.75)"/>
                  <stop offset="100%" stop-color="rgba(255,77,109,0)"/>
                </radialGradient>
                <linearGradient id="mapBg" x1="0" y1="0" x2="1" y2="1">
                  <stop offset="0%" stop-color="rgba(13,20,37,.85)"/>
                  <stop offset="100%" stop-color="rgba(8,12,24,.85)"/>
                </linearGradient>
              </defs>
              <rect x="0" y="0" width="820" height="360" rx="18" fill="url(#mapBg)" stroke="rgba(255,255,255,.10)"/>
              <!-- pseudo-world contours -->
              <path d="M115,205 C110,160 170,140 210,150 C270,165 260,235 215,245 C170,255 130,250 115,205 Z" fill="rgba(78,161,255,.08)" stroke="rgba(78,161,255,.14)"/>
              <path d="M345,210 C330,165 380,135 430,140 C490,148 520,190 498,232 C478,270 388,270 345,210 Z" fill="rgba(46,233,197,.08)" stroke="rgba(46,233,197,.14)"/>
              <path d="M585,200 C575,155 625,130 690,150 C745,167 745,230 700,248 C650,270 595,250 585,200 Z" fill="rgba(255,191,68,.07)" stroke="rgba(255,191,68,.12)"/>
              <g id="mapPoints"></g>
              <g>
                <text x="20" y="28" fill="rgba(232,238,252,.70)" font-size="12" font-family="var(--mono)">Synthetic Site Map • Hover points for details</text>
              </g>
            </svg>
          </div>

          <div class="callout">
            <h3>How clients use this</h3>
            <div class="mapNote">
              SanaClis can present this as a <b>risk overlay</b> for:
              <ul>
                <li>Regulatory submission readiness (data integrity)</li>
                <li>Licensing/M&A diligence (replication & stability risk)</li>
                <li>Trial redesign decisions (endpoint fragility & regimes)</li>
              </ul>
              The map becomes a decision artifact: <b>where risk concentrates</b>, which sites to audit, and how much confidence to assign to observed effects.
            </div>
            <div class="mapNote" style="margin-top:10px;">
              <b>Key differentiation:</b> we treat site signals like cybersecurity telemetry—high-dimensional fingerprints, not single metrics.
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel span2">
      <div class="panelHeader">
        <h2>Top 40 High-Value Analytic Products</h2>
        <div class="hint">Filterable list • relevance-rated • technique included</div>
      </div>
      <div class="panelBody">
        <div class="items" id="items">
          <div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">01</span> Structural Stability of Therapeutic Signal</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Nonlinear dynamic system modeling + stability region mapping</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">02</span> Replication Probability Modeling</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Bayesian posterior predictive modeling + shrinkage</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">03</span> Threshold Fragility Index (DSN/ANC)</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Boundary sensitivity + threshold elasticity</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">04</span> Regime Shift Detection in Recovery</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> HMM / change-point detection</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">05</span> Hazard Shape Stability (Season)</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Time-varying hazard + spline decomposition</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">06</span> Signal vs Noise Decomposition</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Variance decomposition + residual structure</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">07</span> Latent State Discovery</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> State-space models + Neural ODE surrogate</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">08</span> Site-Level Behavioral Anomaly Detection</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Entropy scoring + temporal anomaly models</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">09</span> Counterfactual Treatment Effect Modeling</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Causal forests + doubly-robust estimation</div>
</div>
<div class="card item tier-1">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">10</span> Structural Collapse Risk Under Drift</div>
    <div class="itemStars" title="Relevance">★★★★★</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Perturbation analysis + tipping-point mapping</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">11</span> Mechanistic Differentiation Map</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Compartment model parameter comparison</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">12</span> Nonlinear Dose–Response Stability</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> SINDy sparse nonlinear identification</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">13</span> Dynamic Variance Compression Scan</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Spectral density + entropy drift</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">14</span> Infection Cluster Topology Modeling</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Spatio-temporal graph clustering</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">15</span> Responder Phenotype Discovery</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Mixture models + unsupervised clustering</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">16</span> Early-Warning Effect Decay</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Rolling hazard drift + sequential tests</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">17</span> Endpoint Elasticity Analysis</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Perturbed endpoint definitions + sensitivity curves</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">18</span> PK/PD Stability Assessment</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> NLME + exposure-response residual stability</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">19</span> Missingness Mechanism Stress Test</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> MNAR sensitivity + causal missingness modeling</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">20</span> Dynamic Hazard Regime Classification</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Regime-switching hazards</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">21</span> Mature vs Immature Neutrophil Dynamics</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Two-compartment maturation-delay modeling</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">22</span> Nonlinearity Discovery (Function Form)</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Gaussian process regression</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">23</span> Lab Calibration Drift Robustness</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Shift detection + invariance tests</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">24</span> Multi-Arm Dynamic Curve Similarity</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Functional data analysis + curve distance metrics</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">25</span> Hierarchical Site Variability Modeling</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Bayesian hierarchical random effects</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">26</span> Time-to-Nadir Distribution Stability</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Distributional modeling + quantile shifts</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">27</span> Overfitting / P-hacking Risk Signals</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Cross-validated instability metrics</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">28</span> Multivariate Endpoint Dependency Stability</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Copula dependence + tail risk checks</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">29</span> Epidemic Wave Decomposition</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Wavelet / peak decomposition of incidence</div>
</div>
<div class="card item tier-2">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">30</span> Interaction Effects Discovery</div>
    <div class="itemStars" title="Relevance">★★★★☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> SHAP interaction + partial dependence</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">31</span> Dynamic Smoothness Improbability Scan</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Curvature constraints + smoothness likelihood</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">32</span> Latent Covariate Influence Mining</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Representation learning + feature discovery</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">33</span> Effect Stability Across Demographics</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Hierarchical stratification + partial pooling</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">34</span> Regulatory Re-analysis Robustness Pack</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Alternative estimand + model comparison</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">35</span> Synthetic Control vs Historical Context</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Synthetic control + external comparator QC</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">36</span> Peak Hazard Compression Analysis</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Functional hazard regression</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">37</span> Outlier Influence & Robust Estimation</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Robust regression + influence functions</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">38</span> Shape-Constrained Recovery Symmetry Test</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Monotone/convex regression + shape tests</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">39</span> Longitudinal Entropy Drift Monitoring</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Information-theoretic drift metrics</div>
</div>
<div class="card item tier-3">
  <div class="itemTop">
    <div class="itemTitle"><span class="idx">40</span> Data Integrity Fingerprints (Timing/Batch)</div>
    <div class="itemStars" title="Relevance">★★★☆☆</div>
  </div>
  <div class="itemTech"><span class="pill">TECH</span> Timestamp granularity + batch-entry detection</div>
</div>
        </div>

        <div class="cta">
          <div>
            <h3>Sample deliverable framing</h3>
            <p>
              We don’t “run stats.” We build a <b>dynamic risk architecture</b> over the clinical system:
              stability of signal, integrity fingerprints, and replication likelihood—formatted as a board-ready package
              with a technical appendix for regulators.
            </p>
          </div>
          <div class="btn" id="exportBtn" title="Export a one-page executive brief (demo)">
            Export Executive Brief <small>PDF-ready</small>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<div class="toast" id="toast">Copied executive brief to clipboard (demo)</div>

<script>
/* -----------------------------
   Synthetic data generator
------------------------------ */
function seededRand(seed) {
  // simple LCG
  let s = seed >>> 0;
  return function() {
    s = (1664525 * s + 1013904223) >>> 0;
    return (s / 4294967296);
  };
}

const demo = {
  neutro: {
    name: "Protective-1 (Neutropenia)",
    kpis: [
      {label:"Structural Stability Score", value:"0.82", delta:"↑ strong mechanistic consistency", cls:"tagGood"},
      {label:"Threshold Fragility Index", value:"0.27", delta:"↓ low boundary sensitivity", cls:"tagGood"},
      {label:"Replication Probability", value:"0.64", delta:"moderate-high under neutral prior", cls:"tagWarn"},
      {label:"Integrity Risk (sites)", value:"2 / 18", delta:"2 sites flagged for audit", cls:"tagWarn"},
    ],
    chart: {
      xLabel: "Cycle 1 day",
      yLabel: "ANC (×10⁹/L)",
      threshold: 0.5,
      regimeX: 7.5,
      // two mean curves
      seriesA: [2.8, 2.2, 1.2, 0.62, 0.44, 0.39, 0.47, 0.78, 1.45, 2.10],
      seriesB: [2.9, 2.3, 1.1, 0.74, 0.61, 0.56, 0.62, 0.98, 1.62, 2.25],
      x:        [1,2,6,7,8,9,10,11,15,21],
    },
    heat: {
      rows: ["Site 01","Site 03","Site 05","Site 07","Site 09","Site 11","Site 14","Site 18"],
      cols: ["Entropy","Variance","Timing","Copula","Smooth","Dropout"],
      // 0..1 risk; higher=more suspicious
      z: [
        [0.18,0.22,0.15,0.25,0.12,0.20],
        [0.25,0.28,0.22,0.30,0.20,0.18],
        [0.21,0.16,0.17,0.19,0.14,0.23],
        [0.65,0.70,0.62,0.74,0.68,0.52], // flagged
        [0.24,0.19,0.25,0.21,0.18,0.27],
        [0.20,0.22,0.18,0.24,0.21,0.19],
        [0.58,0.61,0.72,0.69,0.55,0.41], // flagged
        [0.26,0.30,0.28,0.27,0.23,0.29],
      ],
    },
    map: {
      points: [
        {id:"Site 01", x:160, y:195, risk:0.18, region:"US/EU"},
        {id:"Site 03", x:190, y:175, risk:0.28, region:"US/EU"},
        {id:"Site 05", x:235, y:210, risk:0.16, region:"US/EU"},
        {id:"Site 07", x:420, y:205, risk:0.70, region:"EU"},
        {id:"Site 09", x:455, y:185, risk:0.21, region:"EU"},
        {id:"Site 11", x:500, y:222, risk:0.22, region:"EU"},
        {id:"Site 14", x:645, y:210, risk:0.61, region:"RU/UA"},
        {id:"Site 18", x:705, y:195, risk:0.30, region:"RU/UA"},
      ]
    }
  },
  flu: {
    name: "BVX-010 (Flu Vaccine)",
    kpis: [
      {label:"Hazard Stability Score", value:"0.74", delta:"peak-wave consistency", cls:"tagGood"},
      {label:"Season Volatility Exposure", value:"0.41", delta:"medium dependence on attack rate", cls:"tagWarn"},
      {label:"Replication Probability", value:"0.52", delta:"requires careful season design", cls:"tagWarn"},
      {label:"Integrity Risk (sites)", value:"1 / 2", delta:"1 site shows variance compression", cls:"tagWarn"},
    ],
    chart: {
      xLabel: "Season week",
      yLabel: "Infection hazard (a.u.)",
      threshold: 0.0,
      regimeX: 9.5,
      seriesA: [0.04,0.06,0.08,0.12,0.18,0.24,0.28,0.32,0.30,0.26,0.20,0.14,0.10,0.07,0.05],
      seriesB: [0.04,0.05,0.07,0.10,0.14,0.18,0.20,0.22,0.21,0.19,0.16,0.12,0.09,0.06,0.05],
      x:       [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],
    },
    heat: {
      rows: ["PL01","PL02","PL03","PL04","PL05","PL06"],
      cols: ["Entropy","Timing","PCR","Symptom","Copula","Smooth"],
      z: [
        [0.20,0.24,0.19,0.25,0.21,0.18],
        [0.22,0.18,0.23,0.20,0.24,0.21],
        [0.58,0.62,0.55,0.60,0.57,0.66], // flagged
        [0.24,0.22,0.20,0.23,0.18,0.19],
        [0.19,0.16,0.18,0.21,0.20,0.17],
        [0.26,0.30,0.25,0.28,0.27,0.24],
      ],
    },
    map: {
      points: [
        {id:"PL01", x:420, y:190, risk:0.21, region:"Poland"},
        {id:"PL02", x:448, y:205, risk:0.22, region:"Poland"},
        {id:"PL03", x:470, y:180, risk:0.62, region:"Poland"},
        {id:"PL04", x:490, y:215, risk:0.19, region:"Poland"},
        {id:"PL05", x:510, y:195, risk:0.17, region:"Poland"},
        {id:"PL06", x:530, y:210, risk:0.30, region:"Poland"},
      ]
    }
  }
};

let currentStudy = "neutro";

/* -----------------------------
   KPI rendering
------------------------------ */
function renderKpis(studyKey) {
  const el = document.getElementById("kpis");
  el.innerHTML = "";
  const k = demo[studyKey].kpis;
  k.forEach((x) => {
    const div = document.createElement("div");
    div.className = "kpi";
    div.innerHTML = `
      <div class="label">${x.label}</div>
      <div class="value">${x.value}</div>
      <div class="delta"><span class="${x.cls}">${x.delta}</span></div>
    `;
    el.appendChild(div);
  });
}

/* -----------------------------
   Simple Canvas chart utility
------------------------------ */
function drawLineChart(canvas, cfg) {
  const ctx = canvas.getContext("2d");
  const W = canvas.width, H = canvas.height;
  ctx.clearRect(0,0,W,H);

  // background
  const bg = ctx.createLinearGradient(0,0,W,H);
  bg.addColorStop(0,"rgba(0,0,0,0.25)");
  bg.addColorStop(1,"rgba(0,0,0,0.05)");
  ctx.fillStyle = bg;
  roundRect(ctx, 0,0,W,H, 16); ctx.fill();

  const pad = 38;
  const left = pad, right = W - 18, top = 18, bottom = H - pad;

  // axes range
  const xs = cfg.x;
  const a = cfg.seriesA;
  const b = cfg.seriesB;
  let ymin = Math.min(...a, ...b);
  let ymax = Math.max(...a, ...b);
  if (cfg.yLabel.includes("ANC")) {
    ymin = 0;
    ymax = Math.max(3.0, ymax*1.05);
  } else {
    ymin = 0;
    ymax = Math.max(0.35, ymax*1.1);
  }

  function xToPx(x) {
    const t = (x - xs[0]) / (xs[xs.length-1] - xs[0]);
    return left + t*(right-left);
  }
  function yToPx(y) {
    const t = (y - ymin) / (ymax - ymin);
    return bottom - t*(bottom-top);
  }

  // grid
  ctx.strokeStyle = "rgba(255,255,255,0.08)";
  ctx.lineWidth = 1;
  for (let i=0;i<5;i++) {
    const y = top + i*(bottom-top)/4;
    ctx.beginPath();
    ctx.moveTo(left, y);
    ctx.lineTo(right, y);
    ctx.stroke();
  }

  // labels
  ctx.fillStyle = "rgba(232,238,252,0.72)";
  ctx.font = "12px var(--mono)";
  ctx.fillText(cfg.yLabel, left, 14);
  ctx.fillText(cfg.xLabel, right-120, H-10);

  // threshold (only meaningful for ANC)
  if (cfg.threshold > 0) {
    const yT = yToPx(cfg.threshold);
    ctx.strokeStyle = "rgba(255,77,109,0.85)";
    ctx.setLineDash([6,4]);
    ctx.beginPath(); ctx.moveTo(left, yT); ctx.lineTo(right, yT); ctx.stroke();
    ctx.setLineDash([]);
    ctx.fillStyle = "rgba(255,77,109,0.92)";
    ctx.fillText("Threshold", right-110, yT-8);
  }

  // regime marker
  const rX = xToPx(cfg.regimeX);
  ctx.strokeStyle = "rgba(255,191,68,0.95)";
  ctx.setLineDash([3,3]);
  ctx.beginPath(); ctx.moveTo(rX, top); ctx.lineTo(rX, bottom); ctx.stroke();
  ctx.setLineDash([]);
  ctx.fillStyle = "rgba(255,191,68,0.95)";
  ctx.fillText("Regime switch", rX+6, top+14);

  // series A
  plotSeries(ctx, xs, a, xToPx, yToPx, "rgba(78,161,255,0.95)");
  // series B
  plotSeries(ctx, xs, b, xToPx, yToPx, "rgba(46,233,197,0.95)");

  // x ticks
  ctx.fillStyle = "rgba(232,238,252,0.62)";
  ctx.font = "11px var(--mono)";
  for (let i=0;i<xs.length;i+=Math.ceil(xs.length/6)) {
    const x = xToPx(xs[i]);
    ctx.fillText(String(xs[i]), x-6, bottom+18);
  }
}

function plotSeries(ctx, xs, ys, xToPx, yToPx, color) {
  ctx.strokeStyle = color;
  ctx.lineWidth = 2.5;
  ctx.beginPath();
  for (let i=0;i<xs.length;i++) {
    const x = xToPx(xs[i]);
    const y = yToPx(ys[i]);
    if (i===0) ctx.moveTo(x,y);
    else ctx.lineTo(x,y);
  }
  ctx.stroke();

  // points
  ctx.fillStyle = color;
  for (let i=0;i<xs.length;i++) {
    const x = xToPx(xs[i]);
    const y = yToPx(ys[i]);
    ctx.beginPath(); ctx.arc(x,y,3.2,0,Math.PI*2); ctx.fill();
  }
}

function roundRect(ctx, x, y, w, h, r) {
  const rr = Math.min(r, w/2, h/2);
  ctx.beginPath();
  ctx.moveTo(x+rr, y);
  ctx.arcTo(x+w, y, x+w, y+h, rr);
  ctx.arcTo(x+w, y+h, x, y+h, rr);
  ctx.arcTo(x, y+h, x, y, rr);
  ctx.arcTo(x, y, x+w, y, rr);
  ctx.closePath();
}

function drawHeatmap(canvas, cfg) {
  const ctx = canvas.getContext("2d");
  const W = canvas.width, H = canvas.height;
  ctx.clearRect(0,0,W,H);

  // background
  ctx.fillStyle = "rgba(0,0,0,0.14)";
  roundRect(ctx, 0,0,W,H, 16); ctx.fill();

  const rows = cfg.rows, cols = cfg.cols, z = cfg.z;
  const padL = 84;
  const padT = 24;
  const padR = 18;
  const padB = 30;

  const gridW = W - padL - padR;
  const gridH = H - padT - padB;

  const cellW = gridW / cols.length;
  const cellH = gridH / rows.length;

  // labels
  ctx.fillStyle = "rgba(232,238,252,0.72)";
  ctx.font = "11px var(--mono)";
  ctx.fillText("Site Fingerprint Heatmap (higher = more suspicious)", 14, 14);

  cols.forEach((c, j) => {
    ctx.fillStyle = "rgba(232,238,252,0.62)";
    ctx.fillText(c, padL + j*cellW + 6, padT - 6);
  });
  rows.forEach((r, i) => {
    ctx.fillStyle = "rgba(232,238,252,0.62)";
    ctx.fillText(r, 14, padT + i*cellH + cellH*0.65);
  });

  // cells
  for (let i=0;i<rows.length;i++) {
    for (let j=0;j<cols.length;j++) {
      const v = z[i][j]; // 0..1
      const x = padL + j*cellW;
      const y = padT + i*cellH;

      // color scale
      const col = heatColor(v);
      ctx.fillStyle = col.fill;
      ctx.strokeStyle = "rgba(255,255,255,0.06)";
      ctx.lineWidth = 1;
      roundRect(ctx, x+2, y+2, cellW-4, cellH-4, 8);
      ctx.fill();
      ctx.stroke();

      // value
      ctx.fillStyle = v>0.60 ? "rgba(12,16,30,.95)" : "rgba(232,238,252,0.78)";
      ctx.font = "11px var(--mono)";
      const txt = (Math.round(v*100)).toString();
      ctx.fillText(txt, x + cellW*0.40, y + cellH*0.60);

      // anomaly glow
      if (v > 0.62) {
        ctx.strokeStyle = "rgba(255,77,109,0.75)";
        ctx.lineWidth = 2;
        roundRect(ctx, x+2, y+2, cellW-4, cellH-4, 8);
        ctx.stroke();
      }
    }
  }

  // legend
  const lx = W - 215, ly = H - 18;
  ctx.fillStyle = "rgba(232,238,252,0.62)";
  ctx.font = "11px var(--mono)";
  ctx.fillText("risk", lx, ly);
  for (let k=0;k<7;k++) {
    const v = k/6;
    const col = heatColor(v);
    ctx.fillStyle = col.fill;
    roundRect(ctx, lx+36 + k*22, ly-10, 18, 10, 4);
    ctx.fill();
  }
}

function heatColor(v) {
  // v: 0..1
  // smooth gradient: blue -> cyan -> amber -> red
  function lerp(a,b,t) { return a + (b-a)*t; }
  function rgba(r,g,b,a) { return `rgba(${r|0},${g|0},${b|0},${a})`; }

  let r,g,b;
  if (v < 0.5) {
    // blue to cyan
    const t = v/0.5;
    r = lerp(78, 46, t);
    g = lerp(161, 233, t);
    b = lerp(255, 197, t);
  } else {
    // cyan to red
    const t = (v-0.5)/0.5;
    r = lerp(46, 255, t);
    g = lerp(233, 77, t);
    b = lerp(197, 109, t);
  }
  const a = 0.12 + 0.70*v;
  return {
    fill: rgba(r,g,b,a)
  };
}

/* -----------------------------
   SVG site map points
------------------------------ */
function renderMap(studyKey) {
  const g = document.getElementById("mapPoints");
  g.innerHTML = "";
  const pts = demo[studyKey].map.points;

  pts.forEach((p) => {
    const risk = p.risk;
    const glow = document.createElementNS("http://www.w3.org/2000/svg","circle");
    glow.setAttribute("cx", p.x);
    glow.setAttribute("cy", p.y);
    glow.setAttribute("r", risk>0.55 ? "28" : "18");
    glow.setAttribute("fill", risk>0.55 ? "url(#glowRed)" : "url(#glowBlue)");
    g.appendChild(glow);

    const dot = document.createElementNS("http://www.w3.org/2000/svg","circle");
    dot.setAttribute("cx", p.x);
    dot.setAttribute("cy", p.y);
    dot.setAttribute("r", risk>0.55 ? "6" : "5");
    dot.setAttribute("fill", risk>0.55 ? "rgba(255,77,109,.95)" : "rgba(78,161,255,.95)");
    dot.setAttribute("stroke", "rgba(255,255,255,.20)");
    dot.setAttribute("stroke-width", "1");
    dot.style.cursor = "pointer";

    const title = document.createElementNS("http://www.w3.org/2000/svg","title");
    const band = risk>0.62 ? "HIGH" : risk>0.40 ? "MEDIUM" : "LOW";
    title.textContent = `${p.id} • Risk: ${Math.round(risk*100)} (${band}) • Region: ${p.region}`;
    dot.appendChild(title);

    g.appendChild(dot);

    const label = document.createElementNS("http://www.w3.org/2000/svg","text");
    label.setAttribute("x", p.x + 10);
    label.setAttribute("y", p.y + 4);
    label.setAttribute("fill", "rgba(232,238,252,.62)");
    label.setAttribute("font-size", "11");
    label.setAttribute("font-family", "var(--mono)");
    label.textContent = p.id;
    g.appendChild(label);
  });
}

/* -----------------------------
   Study switch + render
------------------------------ */
function renderAll(studyKey) {
  currentStudy = studyKey;
  renderKpis(studyKey);

  const traj = document.getElementById("trajChart");
  drawLineChart(traj, demo[studyKey].chart);

  const heat = document.getElementById("heatChart");
  drawHeatmap(heat, demo[studyKey].heat);

  renderMap(studyKey);
}

document.getElementById("studySeg").addEventListener("click", (e) => {
  const btn = e.target.closest("button");
  if (!btn) return;
  document.querySelectorAll("#studySeg button").forEach(b => b.classList.remove("active"));
  btn.classList.add("active");
  renderAll(btn.dataset.study);
});

/* -----------------------------
   Filter 40 items
------------------------------ */
const search = document.getElementById("globalSearch");
search.addEventListener("input", () => {
  const q = search.value.trim().toLowerCase();
  document.querySelectorAll("#items .item").forEach((card) => {
    const txt = card.innerText.toLowerCase();
    card.style.display = (!q || txt.includes(q)) ? "" : "none";
  });
});

/* -----------------------------
   Export brief (demo)
------------------------------ */
function showToast(msg) {
  const t = document.getElementById("toast");
  t.textContent = msg;
  t.classList.add("show");
  setTimeout(() => t.classList.remove("show"), 1600);
}

document.getElementById("exportBtn").addEventListener("click", async () => {
  const study = demo[currentStudy];
  const lines = [
    "FDS — Executive Brief (Demo / Synthetic)",
    `Study: ${study.name}`,
    "",
    "Top Signals:",
    ...study.kpis.map(k => `- ${k.label}: ${k.value} (${
      k.delta.replace(/\s+/g,' ').trim()
    })`),
    "",
    "Why this matters:",
    "- Stability analysis: distinguishes mechanistic signal vs threshold artifacts",
    "- Integrity layer: identifies site fingerprints inconsistent with biology / operations",
    "- Replication probability: provides decision-grade uncertainty for boards/investors",
    "",
    "Note: Synthetic dashboard for capability demonstration only."
  ].join("\n");

  try {
    await navigator.clipboard.writeText(lines);
    showToast("Copied executive brief to clipboard (demo)");
  } catch (err) {
    showToast("Clipboard blocked — select and copy from console (demo)");
    console.log(lines);
  }
});

// initial render
renderAll("neutro");
</script>
</body>
</html>
